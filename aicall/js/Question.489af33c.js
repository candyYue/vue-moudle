(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"0SQa":function(t,e,a){"use strict";var s=a("z/u3");a.n(s).a},"8/dx":function(t,e,a){"use strict";a.r(e);var s,n=a("iv4g"),i=(a("ls82"),a("MECJ")),r=(a("FLlr"),a("yT7P")),o=a("QIt3"),l=a("L2JU"),c=a("gXkj"),u=a("AAoU"),p=a("nc4g"),d=a("+7xr"),m={data:function(){return{api:o.a,detailcard:!1,detail:{id:null,standard:"",common:[""],answer:"",scripts:"",label:""},questionImport:!1,script_id:"",queSelectList:[{id:"",title:"全部问题"}]}},components:{ModalImport:u.a},computed:Object(r.a)({},Object(l.c)({questionList:"AICall/questionList",questionListTotal:"AICall/questionListTotal",scriptList:"AICall/scriptList"})),methods:Object(r.a)({},Object(l.b)({getQuestions:"AICall/getQuestions",delQuestions:"AICall/delQuestions",getScripts:"AICall/getScripts"}),{handleImport:function(){this.questionImport=!0},changeScript:function(t){p.a.$emit("reloadList",d.PAGE_HANDLER.SEARCH,{script_id:t})},getImportList:function(){p.a.$emit("reloadList",d.PAGE_HANDLER.ADD)},orderValue:function(t){return[1===t.onhook?"结束后挂机":"",1===t.repeat?"重复回答":"",1===t.manual?"转为人工坐席":"",1===t.interrupt?"允许打断":"",1===t.send_sms?"发送短信":""].filter(function(t){return""!==t}).join("，")},showdetail:function(t,e,a){if("action"===a.property)return!1;this.detailcard=!0,this.detail=t},handleNew:function(t){if("new"===t&&this.questionListTotal&&this.questionListTotal>=2e3)return c.b.$warning({content:"您的标准问题数量已达2000个，无法创建"}),!1;this.$router.push({name:"AICall-question-id",params:{id:t}})},handleDelete:function(t){var e=this;c.a.$error({title:"删除提示",content:"您确定要删除该问题吗？",successCallback:function(){e.delQuestions({id:t}).then(function(t){0===t.status&&(p.a.$emit("reloadList",d.PAGE_HANDLER.DEL),c.b.$success({content:"删除成功"}),e.detailcard=!1)})}})}}),mounted:(s=Object(i.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getScripts();case 2:this.queSelectList=Object(n.a)(this.queSelectList).concat(Object(n.a)(this.scriptList)),this.script_id=+this.$route.query.script_id||"";case 4:case"end":return t.stop()}},t,this)})),function(){return s.apply(this,arguments)})},f=(a("HIre"),a("KHd+")),h=Object(f.a)(m,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"question"},[a("table-pagination",{attrs:{name:"问题",router:"AICall-question",pageKey:"question",total:t.questionListTotal},on:{handleNew:function(e){t.handleNew("new")},getList:t.getQuestions}},[a("div",{staticClass:"action-column",attrs:{slot:"new"},slot:"new"},[a("el-select",{attrs:{placeholder:"请选择话术","popper-class":"select-width154"},on:{change:t.changeScript},model:{value:t.script_id,callback:function(e){t.script_id=e},expression:"script_id"}},t._l(t.queSelectList,function(t,e){return a("el-option",{key:e,attrs:{label:t.title,value:t.id,title:t.title}})})),a("div",{staticClass:"float-right"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){t.handleNew("new")}}},[t._v("新建问题")]),a("el-button",{attrs:{icon:"el-icon-import",type:"info"},on:{click:t.handleImport}},[t._v("导入问题")])],1)],1),a("el-table",{attrs:{data:t.questionList},on:{"row-click":t.showdetail}},[a("el-table-column",{attrs:{width:"60","class-name":"visible-cell"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.audio_id?a("el-button",{attrs:{type:"text",icon:"el-icon-tip"}}):t._e()]}}])}),a("el-table-column",{attrs:{label:"标准问题",align:"left",prop:"standard"}}),a("el-table-column",{attrs:{label:"机器人回答",align:"left",prop:"answer",width:"450"}}),a("el-table-column",{attrs:{label:"所属话术",prop:"scripts"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{attrs:{title:e.row.scripts?e.row.scripts.map(function(t){return t.name}).join(" / "):""}},[t._v(t._s(e.row.scripts?e.row.scripts.map(function(t){return t.name}).join(" / "):""))])]}}])}),a("el-table-column",{attrs:{label:"标签",prop:"label"}}),a("el-table-column",{attrs:{label:"指令",prop:"order"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.orderValue(e.row)))])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"100",prop:"action","class-name":"visible-cell"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(a){a.stopPropagation(),t.handleNew(e.row.id)}}}),a("el-button",{attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){a.stopPropagation(),t.handleDelete(e.row.id)}}})]}}])})],1)],1),a("transition",{attrs:{name:"fade-in"}},[t.detailcard?a("div",{staticClass:"showdetail"},[a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[t._v("问题详情")]),a("span",{staticClass:"card-close",on:{click:function(e){t.detailcard=!1}}},[a("i",{staticClass:"el-icon-close"})])]),a("div",{staticClass:"card-body"},[a("div",[a("h6",{staticClass:" overflow-hidden"},[t._v("标准问题：\n            "),a("div",{staticClass:"card-action"},[a("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(e){t.handleNew(t.detail.id)}}}),a("el-button",{attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(e){t.handleDelete(t.detail.id)}}})],1)]),a("p",[t._v(t._s(t.detail.standard))])]),a("hr"),a("div",[a("h6",[t._v("相似问题：")]),a("div",{staticClass:"commons"},t._l(t.detail.common,function(e,s){return a("p",{key:s},[t._v(t._s(e))])}))]),a("div",{staticClass:"card-answer"},[a("h6",[t._v("智能外呼机器人回答：")]),a("p",[t._v(t._s(t.detail.answer))])]),a("hr"),a("div",{staticClass:"card-footer"},[a("div",[a("h6",[t._v("所属话术：")]),a("p",[t._v(t._s(t.detail.scripts?t.detail.scripts.map(function(t){return t.name}).join(" / "):""))])]),2===t.detail.jump_type?a("div",[a("h6",[t._v("跳转至话术节点：")]),t._l(t.detail.scripts,function(e,s){return e.jump_node?a("p",{key:s,staticClass:"jump-node"},[t._v(t._s(e.jump_node?e.name+"/"+e.jump_node.name:""))]):t._e()})],2):t._e(),a("div",[a("h6",[t._v("标签：")]),a("p",[t._v(t._s(t.detail.label))])])])])]):t._e()]),a("modal-import",{attrs:{"data-key":"问题","template-url":t.api.AICall.tmpQuestions,"import-url":t.api.AICall.impQuestions,"get-list":t.getImportList},model:{value:t.questionImport,callback:function(e){t.questionImport=e},expression:"questionImport"}})],1)},[],!1,null,"77b60210",null);e.default=h.exports},AAoU:function(t,e,a){"use strict";a("f3/d"),a("xfY5"),a("ls82");var s,n=a("MECJ"),i=(a("rGqo"),a("yt8O"),a("/8Fb"),a("QIt3")),r=a("iYJL"),o={name:"progress-modal",props:{value:{type:Boolean,default:!1},dataKey:{type:String},title:{type:String,default:"导入"},importUrl:String,importData:Object,getList:Function,onError:Function},data:function(){return{api:i.a,hash:null,result:{}}},computed:{successStatus:function(){return 100===this.result.per}},watch:{value:function(t){t&&this.startImport()}},methods:{startImport:function(){var t=this,e=new FormData;Object.entries(this.importData).map(function(t){e.append(t[0],t[1])});var a=new XMLHttpRequest;a.open("POST",this.importUrl,!0),a.send(e),a.onload=function(){var e=Object(n.a)(regeneratorRuntime.mark(function e(s){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:4===a.readyState&&200===a.status&&(0===(n=JSON.parse(a.responseText||a.response)).status?(t.hash=n.data.hash,t.getProgress()):(t.onError?t.onError(n.info):t.$messageTip.$error({content:n.info}),t.close()));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},getProgress:(s=Object(n.a)(regeneratorRuntime.mark(function t(){var e,a,s=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=null,t.next=3,Object(r.a)(i.a.AICall.getProgress,{hash:this.hash});case 3:if(a=t.sent,this.result=a.data,10004!==a.status){t.next=8;break}return this.close(),t.abrupt("return");case 8:100!==Number(a.data.per)?e=setTimeout(function(){s.getProgress(),clearTimeout(e)},1e3):(a.data.error||setTimeout(function(){s.close()},2e3),a.data.total-a.data.error&&this.getList());case 9:case"end":return t.stop()}},t,this)})),function(){return s.apply(this,arguments)}),close:function(){this.$emit("input",!1)}}},l=(a("PcAL"),a("KHd+")),c={name:"import-modal",components:{ModalProgress:Object(l.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{staticClass:"modal-padding-45 modal-progress",attrs:{title:t.dataKey+"导入",showFooter:!1,showClose:t.successStatus},on:{cancel:t.close},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[a("el-progress",{attrs:{"stroke-width":10,color:"#52BBFF",status:t.successStatus?"success":"",percentage:t.result.per||0}}),t.successStatus?a("div",[a("p",[t._v("导入完成，共"+t._s(t.result.total)+"条，导入成功"),a("span",{staticClass:"success-text"},[t._v(t._s(t.result.total-t.result.error))]),t._v("条，导入失败"),a("span",{staticClass:"error-text",attrs:{span:""}},[t._v(t._s(t.result.error))]),t._v("条，")]),t.result.error?a("p",[a("a",{attrs:{href:t.api.AICall.getImportReport+"?hash="+this.hash}},[t._v("下载错误报告")]),t._v("，查看失败原因。")]):t._e()]):a("div",[t._v("正在导入"+t._s(t.dataKey)+"数据...…")])],1)},[],!1,null,null,null).exports},props:{value:{type:Boolean,default:!1},dataKey:{type:String},title:{type:String,default:"导入"},templateUrl:String,importUrl:String,accept:{type:String,default:".csv"},getList:Function},data:function(){return{modal:!0,progressModal:!1,file:null,importData:{},errorInfo:""}},methods:{importFile:function(){this.$refs.fileInput.click(),this.$refs.fileButton.$el.blur()},handleChange:function(t){this.errorInfo="";var e=t.target.files[0];e.name.slice(-4)===this.accept?(this.file=e,this.importData={file:e}):this.errorInfo="请选择".concat(this.accept,"格式的文件")},handleSave:function(){this.file?(this.progressModal=!0,this.close()):this.errorInfo="请选择需要导入的文件"},close:function(){this.$emit("input",!1),this.$refs.fileInput.value=null,this.file=null}}},u=(a("0SQa"),Object(l.a)(c,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Modal",{staticClass:"modal-padding-40 modal-import",attrs:{title:t.dataKey+"导入",comfirmText:"开始导入"},on:{comfirm:t.handleSave,cancel:t.close},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[a("div",{staticClass:"modal-import__descr"},[a("p",[t._v("1、请按照导入模板的格式来准备要导入的数据。"),a("a",{attrs:{href:t.templateUrl}},[t._v("下载导入模板")])]),a("p",[t._v("2、选择需要导入的CSV文件")])]),a("p",[a("el-button",{ref:"fileButton",attrs:{type:"info"},on:{click:t.importFile}},[t._v("选择文件")]),t.errorInfo?a("span",{staticClass:"modal-import__info modal-import__error"},[t._v(t._s(t.errorInfo))]):a("span",{staticClass:"modal-import__info modal-import__file-name"},[t._v(t._s(t.file&&t.file.name))])],1),a("input",{ref:"fileInput",attrs:{type:"file",hidden:"",accept:t.accept},on:{change:t.handleChange}})]),a("modal-progress",{attrs:{"data-key":t.dataKey,"import-url":t.importUrl,"import-data":t.importData,getList:t.getList},model:{value:t.progressModal,callback:function(e){t.progressModal=e},expression:"progressModal"}})],1)},[],!1,null,null,null));e.a=u.exports},HIre:function(t,e,a){"use strict";var s=a("QbFI");a.n(s).a},PcAL:function(t,e,a){"use strict";var s=a("t537");a.n(s).a},QbFI:function(t,e,a){},t537:function(t,e,a){},"z/u3":function(t,e,a){}}]);