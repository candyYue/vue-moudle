(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"0oTl":function(e,t,i){"use strict";i.r(t);i("dRSK");var l=i("yT7P"),n=i("L2JU"),a=i("gXkj"),r=i("Cwky"),s=i("nc4g"),o=i("+7xr"),d={data:function(){return{fieldsRules:r.b,fieldsModal:!1,modalType:0,fieldsModalTit:{0:"新建自定义字段",1:"编辑自定义字段"},fieldsform:{id:"",title:""},loading:!1}},computed:Object(l.a)({},Object(n.c)({fieldsListTotal:"AICall/fieldsListTotal",fieldsList:"AICall/fieldsList"})),methods:Object(l.a)({},Object(n.b)({getFields:"AICall/getFields",delFields:"AICall/delFields",saveFields:"AICall/saveFields"}),{handleNew:function(){if(this.fieldsListTotal>=80)return a.b.$warning({content:"您的字段数量已达80个，无法新建"}),!1;this.openModal(),this.modalType=0,this.fieldsform.id=""},handleEdit:function(e){var t=e.id,i=e.title;this.fieldsform={id:t,title:i},this.modalType=1,this.openModal()},handleDelete:function(e){var t=this;a.a.$error({title:"删除提示",content:"您确定要删除该自定义字段吗？<br/>删除将会影响相应话术的使用。",comfirmText:"确定删除",btnChange:!0,successCallback:function(){t.delFields({id:e}).then(function(e){0===e.status&&(s.a.$emit("reloadList",o.PAGE_HANDLER.DEL),a.b.$success({content:"删除成功"}))})}})},handleSave:function(){var e=this,t=this.fieldsform,i=t.id,l=t.title;if(i&&this.fieldsList.find(function(e){return e.id===i}).title===l)return this.closeModal(),!1;this.$refs.fieldsform.validate(function(t){if(!t)return!1;e.loading=!0,e.saveFields(e.fieldsform).then(function(t){0===t.status&&(e.closeModal(),a.b.$success({content:"保存成功"}),0===e.modalType?s.a.$emit("reloadList",o.PAGE_HANDLER.ADD):s.a.$emit("reloadList",o.PAGE_HANDLER.EDIT)),e.loading=!1})})},openModal:function(){this.fieldsModal=!0,this.$refs.fieldsform.resetFields(),this.loading=!1},closeModal:function(){this.fieldsModal=!1}})},u=i("KHd+"),c=Object(u.a)(d,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("table-pagination",{attrs:{name:"自定义字段",router:"AICall-talk-fields",pageKey:"fields",total:e.fieldsListTotal},on:{handleNew:e.handleNew,getList:e.getFields}},[i("el-table",{attrs:{data:e.fieldsList}},[i("el-table-column",{attrs:{prop:"title",label:"自定义字段",align:"left"}}),i("el-table-column",{attrs:{label:"操作",width:"100","class-name":"visible-cell"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(i){e.handleEdit(t.row)}}}),i("el-button",{attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(i){e.handleDelete(t.row.id)}}})]}}])})],1)],1),i("Modal",{class:["modal-padding-30",{"modal-has-tip":1===e.modalType}],attrs:{title:e.fieldsModalTit[e.modalType],loading:e.loading,draggable:""},on:{cancel:e.closeModal,comfirm:e.handleSave},model:{value:e.fieldsModal,callback:function(t){e.fieldsModal=t},expression:"fieldsModal"}},[1===e.modalType?i("p",{staticClass:"modal-tip"},[e._v("所编辑的字段需要在相应的话术编辑页面进行保存才可生效。")]):e._e(),i("el-form",{ref:"fieldsform",attrs:{model:e.fieldsform,rules:e.fieldsRules,"label-width":"80px"},nativeOn:{submit:function(t){return e.handleSave(t)}}},[i("el-form-item",{attrs:{label:"字段名称",prop:"title"}},[i("el-input",{attrs:{maxlength:"15"},model:{value:e.fieldsform.title,callback:function(t){e.$set(e.fieldsform,"title","string"==typeof t?t.trim():t)},expression:"fieldsform.title"}})],1)],1)],1)],1)},[],!1,null,null,null);t.default=c.exports},Cwky:function(e,t,i){"use strict";i.d(t,"f",function(){return a}),i.d(t,"c",function(){return r}),i.d(t,"a",function(){return s}),i.d(t,"b",function(){return o}),i.d(t,"d",function(){return d}),i.d(t,"e",function(){return u});var l=i("oI6n"),n={required:!0,message:"请输入话术内容",trigger:["blur","change"]},a={title:[{required:!0,message:"请输入话术名称",trigger:["blur","change"]},{validator:function(e,t,i){l.b.test(t)?i(new Error("请不要输入非法字符")):i()},trigger:["blur","change"]}],"noinput[0].text":[n,l.a],"noinput[1].text":[n,l.a],"noinput[2].text":[n,l.a],"nomatch[0].text":[n,l.a],"nomatch[1].text":[n,l.a],"nomatch[2].text":[n,l.a],intention:{validator:function(e,t,i){if(t.value&&!t.text)return i(new Error("请输入话术"));i()},trigger:["blur","change"]},session:{validator:function(e,t,i){if(t.value&&!t.text)return i(new Error("请输入话术"));i()},trigger:["blur","change"]}},r={cluster_id:{required:!0,message:"请选择聚类名称",trigger:["blur","change"]},script:[{required:!0,message:"请输入话术",trigger:["blur","change"]},{validator:function(e,t,i){l.b.test(t)?i(new Error("请不要输入非法字符")):i()},trigger:["blur","change"]}]},s={title:[{required:!0,message:"请输入聚类名称",trigger:["blur","change"]},l.a]},o={title:[{required:!0,message:"请输入字段内容",trigger:["blur","change"]},l.a]},d={title:[{required:!0,message:"请输入标签内容",trigger:["blur","change"]},l.a]},u={title:[{required:!0,message:"请输入短信名称",trigger:["blur","change"]},l.a],content:[{required:!0,message:"请输入短信内容",trigger:["blur","change"]},l.a]}},oI6n:function(e,t,i){"use strict";i.d(t,"b",function(){return l}),i.d(t,"a",function(){return n});var l=/[<>&'"]{1,}/,n={validator:function(e,t,i){t&&l.test(t)&&i(new Error("请不要输入非法字符")),i()},trigger:["change","blur"]}}}]);