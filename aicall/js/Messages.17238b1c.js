(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"2FR7":function(e,t,s){"use strict";s.r(t);var a=s("yT7P"),n=s("L2JU"),r=s("gXkj"),l=s("Cwky"),i=s("nc4g"),o=s("+7xr"),c={data:function(){return{messagesRules:l.e,messagesModal:!1,modalType:0,messagesModalTit:{0:"新建短信",1:"编辑短信"},messagesform:{id:"",title:"",content:""},loading:!1}},computed:Object(a.a)({},Object(n.c)({messagesListTotal:"AICall/messagesListTotal",messagesList:"AICall/messagesList"})),methods:Object(a.a)({},Object(n.b)({getMessages:"AICall/getMessages",delMessages:"AICall/delMessages",saveMessages:"AICall/saveMessages"}),{handleNew:function(){if(this.messagesListTotal>=20)return r.b.$warning({content:"您的短信模板数量已达20个，无法新建"}),!1;this.openModal(),this.modalType=0,this.messagesform.id=""},handleEdit:function(e){var t=e.id,s=e.title,a=e.content;this.openModal(),this.modalType=1,this.messagesform={id:t,title:s,content:a}},handleDelete:function(e){var t=this;r.a.$error({title:"删除提示",content:"您确定要删除该短信模板吗？<br/>删除可能会导致无法发送相关短信。",comfirmText:"确定删除",btnChange:!0,successCallback:function(){t.delMessages({id:e}).then(function(e){0===e.status&&(i.a.$emit("reloadList",o.PAGE_HANDLER.DEL),r.b.$success({content:"删除成功"}))})}})},handleSave:function(){var e=this,t=this.messagesform,s={id:t.id,content:t.content,title:t.title};this.$refs.messagesform.validate(function(t){if(!t)return!1;e.loading=!0,e.saveMessages(s).then(function(t){0===t.status&&(e.closeModal(),r.b.$success({content:"保存成功"}),0===e.modalType?i.a.$emit("reloadList",o.PAGE_HANDLER.ADD):i.a.$emit("reloadList",o.PAGE_HANDLER.EDIT)),e.loading=!1})})},openModal:function(){this.messagesModal=!0,this.$refs.messagesform.resetFields(),this.messagesform.content="",this.loading=!1},closeModal:function(){this.messagesModal=!1}})},g=s("KHd+"),u=Object(g.a)(c,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("table-pagination",{attrs:{name:"短信",router:"AICall-talk-messages",pageKey:"message",total:e.messagesListTotal},on:{handleNew:e.handleNew,getList:e.getMessages}},[s("el-table",{attrs:{data:e.messagesList}},[s("el-table-column",{attrs:{prop:"title",label:"短信名称",align:"left",width:"200"}}),s("el-table-column",{attrs:{label:"短信内容","class-name":"tags-cell"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{attrs:{title:t.row.content}},[e._v(e._s(t.row.content))])]}}])}),s("el-table-column",{attrs:{label:"操作",width:"100","class-name":"visible-cell"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(s){e.handleEdit(t.row)}}}),s("el-button",{attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(s){e.handleDelete(t.row.id)}}})]}}])})],1)],1),s("Modal",{staticClass:"modal-padding-30",attrs:{title:e.messagesModalTit[e.modalType],draggable:"",loading:e.loading},on:{cancel:e.closeModal,comfirm:e.handleSave},model:{value:e.messagesModal,callback:function(t){e.messagesModal=t},expression:"messagesModal"}},[s("el-form",{ref:"messagesform",attrs:{model:e.messagesform,rules:e.messagesRules,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"短信名称",prop:"title"}},[s("el-input",{attrs:{maxlength:"20"},model:{value:e.messagesform.title,callback:function(t){e.$set(e.messagesform,"title","string"==typeof t?t.trim():t)},expression:"messagesform.title"}})],1),s("el-form-item",{attrs:{label:"短信内容",prop:"content"}},[s("el-input",{attrs:{rows:"4",type:"textarea",maxlength:"70"},model:{value:e.messagesform.content,callback:function(t){e.$set(e.messagesform,"content","string"==typeof t?t.trim():t)},expression:"messagesform.content"}})],1)],1)],1)],1)},[],!1,null,null,null);t.default=u.exports},Cwky:function(e,t,s){"use strict";s.d(t,"f",function(){return r}),s.d(t,"c",function(){return l}),s.d(t,"a",function(){return i}),s.d(t,"b",function(){return o}),s.d(t,"d",function(){return c}),s.d(t,"e",function(){return g});var a=s("oI6n"),n={required:!0,message:"请输入话术内容",trigger:["blur","change"]},r={title:[{required:!0,message:"请输入话术名称",trigger:["blur","change"]},{validator:function(e,t,s){a.b.test(t)?s(new Error("请不要输入非法字符")):s()},trigger:["blur","change"]}],"noinput[0].text":[n,a.a],"noinput[1].text":[n,a.a],"noinput[2].text":[n,a.a],"nomatch[0].text":[n,a.a],"nomatch[1].text":[n,a.a],"nomatch[2].text":[n,a.a],intention:{validator:function(e,t,s){if(t.value&&!t.text)return s(new Error("请输入话术"));s()},trigger:["blur","change"]},session:{validator:function(e,t,s){if(t.value&&!t.text)return s(new Error("请输入话术"));s()},trigger:["blur","change"]}},l={cluster_id:{required:!0,message:"请选择聚类名称",trigger:["blur","change"]},script:[{required:!0,message:"请输入话术",trigger:["blur","change"]},{validator:function(e,t,s){a.b.test(t)?s(new Error("请不要输入非法字符")):s()},trigger:["blur","change"]}]},i={title:[{required:!0,message:"请输入聚类名称",trigger:["blur","change"]},a.a]},o={title:[{required:!0,message:"请输入字段内容",trigger:["blur","change"]},a.a]},c={title:[{required:!0,message:"请输入标签内容",trigger:["blur","change"]},a.a]},g={title:[{required:!0,message:"请输入短信名称",trigger:["blur","change"]},a.a],content:[{required:!0,message:"请输入短信内容",trigger:["blur","change"]},a.a]}},oI6n:function(e,t,s){"use strict";s.d(t,"b",function(){return a}),s.d(t,"a",function(){return n});var a=/[<>&'"]{1,}/,n={validator:function(e,t,s){t&&a.test(t)&&s(new Error("请不要输入非法字符")),s()},trigger:["change","blur"]}}}]);